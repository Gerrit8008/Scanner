<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Vulnerability Scanner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="header">
        <img src="/static/images/logo.png" alt="Company Logo" class="logo">
        <h1>Cybersecurity Vulnerability Scanner</h1>
        <p>Comprehensive security analysis for your systems and networks</p>
    </div>

    <div class="container">
        <div class="form-container">
            <div class="company-info">
                <h3>Central Georgia Technology</h3>
                <p>320 Dividend Dr, Peachtree City, 30369</p>
                <p>Phone: +1-470-481-0400</p>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    Complete Security Analysis
                </div>
                <div class="card-body">
                    <p class="card-text">
                        Our comprehensive security scanner analyzes both your system and network vulnerabilities.
                        We combine basic system scanning with enhanced network and web application scanning
                        to provide a complete picture of your security posture.
                    </p>

                    <!-- MODIFIED FORM: Removed target field and updated text -->
                    <form id="combinedScanForm" action="/scan" method="post">
                        <div class="mb-3">
                            <label for="name" class="form-label required">Full Name</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label required">Email Address</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                            <div class="form-text">We'll use this to analyze your email domain security and send you the results.</div>
                        </div>
                        <div class="mb-3">
                            <label for="company" class="form-label">Company Name</label>
                            <input type="text" class="form-control" id="company" name="company">
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="phone" name="phone">
                        </div>
                        
                        <!-- Hidden fields for client OS detection -->
                        <input type="hidden" id="client_os" name="client_os" value="Unknown">
                        <input type="hidden" id="client_browser" name="client_browser" value="Unknown">
                        <input type="hidden" id="windows_version" name="windows_version" value="">

                        <div class="domain-check">
                            <h3>Comprehensive Security Analysis</h3>
                            <p>
                                We'll analyze:
                            </p>
                            <ul>
                                <li><strong>Your System:</strong> OS security, browser configuration, installed software</li>
                                <li><strong>Email Security:</strong> SPF, DKIM, and DMARC configurations for your email domain</li>
                                <li><strong>Network Security:</strong> Open ports, vulnerable services, firewall configuration</li>
                                <li><strong>Web Application:</strong> SSL/TLS configuration, security headers, CMS vulnerabilities</li>
                            </ul>
                            <p class="text-info">
                                <strong>Note:</strong> All scans will be performed on the domain extracted from your email address.
                            </p>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-scan btn-lg" id="startScanBtn">Start Comprehensive Scan</button>
                        </div>
                    </form>

                    <div class="loading" id="loadingIndicator">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3">Initializing scan... This may take a few moments.</p>
                    </div>
                </div>
            </div>
            
            <!-- Quick Test Scan section removed -->
            
            <div class="enhanced-features">
                <h2>Advanced Security Scan Features</h2>
                <ul>
                    <li><strong>SSL/TLS Certificate Analysis</strong> - Check for expiration dates, weak encryption, and misconfiguration issues</li>
                    <li><strong>HTTP Security Headers Assessment</strong> - Scan for missing or misconfigured security headers</li>
                    <li><strong>CMS Detection and Vulnerability Checking</strong> - Identify content management systems and check for known vulnerabilities</li>
                    <li><strong>DNS Configuration Analysis</strong> - Examine DNS records for misconfigurations or security issues</li>
                    <li><strong>Email Security Verification</strong> - Check SPF, DKIM, and DMARC records for email security</li>
                    <li><strong>Cookie Security Analysis</strong> - Check for secure flags, HttpOnly settings, and SameSite attributes</li>
                    <li><strong>Web Application Framework Detection</strong> - Identify frameworks and potential known vulnerabilities</li>
                    <li><strong>Basic Content Crawling</strong> - Look for sensitive information exposure in robots.txt or common paths</li>
                    <li><strong>Risk Scoring</strong> - Get an overall security score with recommendations</li>
                    <li><strong>Detailed Report</strong> - Receive a comprehensive security assessment report</li>
                </ul>
            </div>
        </div>
        
        <!-- Scan Progress Container (initially hidden) -->
        <div class="progress-container" id="progressContainer">
            <div class="card">
                <div class="card-header">
                    Scan in Progress
                </div>
                <div class="card-body">
                    <p>Please do not close this window. Your scan results will be displayed once completed.</p>
                    
                    <div class="progress-step">
                        <h3>Overall Progress</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="overallProgress" style="width: 0%">0%</div>
                        </div>
                    </div>
                    
                    <div class="progress-step">
                        <h3>Initializing Scan</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="initProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="initStatus">⏳ Preparing scan environment...</p>
                    </div>
                    
                    <div class="progress-step">
                        <h3>System Security Analysis</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="systemProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="systemStatus">⏳ Waiting to start system scan...</p>
                    </div>
                    
                    <div class="progress-step">
                        <h3>Network Discovery</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="discoveryProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="discoveryStatus">⏳ Waiting for system analysis to complete</p>
                    </div>
                    
                    <div class="progress-step">
                        <h3>Vulnerability Analysis</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="vulnProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="vulnStatus">⏳ Waiting for network discovery to complete</p>
                    </div>
                    
                    <div class="progress-step">
                        <h3>Web Application Security Audit</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="webProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="webStatus">⏳ Waiting for vulnerability analysis to complete</p>
                    </div>
                    
                    <div class="progress-step">
                        <h3>Report Generation</h3>
                        <div class="progress-bar-container">
                            <div class="progress-fill" id="reportProgress" style="width: 0%">Pending</div>
                        </div>
                        <p class="progress-step-status status-pending" id="reportStatus">⏳ Waiting for security audit to complete</p>
                    </div>
                    
                    <div class="text-center mt-4">
                        <p><strong>Estimated completion time:</strong> <span id="estimatedTime">10 minutes 45 seconds</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2025 Central Georgia Technology. All rights reserved.</p>
    </div>

    <script src="{{ url_for('static', filename='js/firewall-test.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Function to detect client OS
        function detectClientOS() {
            let os = "Unknown";
            const userAgent = window.navigator.userAgent;
            
            if (userAgent.indexOf("Win") !== -1) os = "Windows";
            else if (userAgent.indexOf("Mac") !== -1) os = "MacOS";
            else if (userAgent.indexOf("Linux") !== -1) os = "Linux";
            else if (userAgent.indexOf("Android") !== -1) os = "Android";
            else if (userAgent.indexOf("iOS") !== -1 || userAgent.indexOf("iPhone") !== -1 || userAgent.indexOf("iPad") !== -1) os = "iOS";
            
            // Set client OS in hidden form fields
            document.getElementById("client_os").value = os;
            
            // Also detect browser
            let browser = "Unknown";
            if (userAgent.indexOf("Chrome") !== -1) browser = "Chrome";
            else if (userAgent.indexOf("Firefox") !== -1) browser = "Firefox";
            else if (userAgent.indexOf("Safari") !== -1) browser = "Safari";
            else if (userAgent.indexOf("Edge") !== -1) browser = "Edge";
            else if (userAgent.indexOf("MSIE") !== -1 || userAgent.indexOf("Trident") !== -1) browser = "Internet Explorer";
            
            document.getElementById("client_browser").value = browser;
            
            // Detect Windows version (approximate)
            let windowsVersion = "";
            if (os === "Windows") {
                if (userAgent.indexOf("Windows NT 10.0") !== -1) windowsVersion = "Windows 10/11";
                else if (userAgent.indexOf("Windows NT 6.3") !== -1) windowsVersion = "Windows 8.1";
                else if (userAgent.indexOf("Windows NT 6.2") !== -1) windowsVersion = "Windows 8";
                else if (userAgent.indexOf("Windows NT 6.1") !== -1) windowsVersion = "Windows 7";
                else windowsVersion = "Older Windows Version";
                
                document.getElementById("windows_version").value = windowsVersion;
            }
            
            console.log("Detected OS:", os, "Browser:", browser, "Windows Version:", windowsVersion);
        }
        
        // Run detection when DOM is loaded
        document.addEventListener('DOMContentLoaded', detectClientOS);
        
        // Form submission
        document.getElementById('combinedScanForm').addEventListener('submit', function(e) {
            // Show the loading indicator
            document.getElementById('startScanBtn').disabled = true;
            document.getElementById('loadingIndicator').style.display = 'block';
        });
      
        // Animation functions remain for visual effect, but now are separate from form submission
        function showProgressAnimation() {
            document.getElementById('loadingIndicator').style.display = 'none';
            document.querySelector('.form-container').style.display = 'none';
            document.getElementById('progressContainer').style.display = 'block';
            
            // Start the progress simulation
            simulateProgress();
        }
        
        // Progress simulation function
        function simulateProgress() {
            // Implementation would remain the same as in the original
        }
    </script>
</body>
</html>
